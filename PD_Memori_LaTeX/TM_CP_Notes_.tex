
%Dades estil capçalera 
%\pagestyle{fancy}
%\rhead{\textbf{ CDVO  \\ 2n. Grau en  Matemàtiques}}
%\lhead{\textbf{Nom: }Marc G******* Ricardo \\ \textbf{NIU: }*****471}
%Perquè capiguen les coses a la capçalera 
%\setlength{\headheight}{25pt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                                              %%%
%%%            %El més bàsic i alguns paquets%                   %%%
%%%                                                              %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%Declarem la classe de document i dimensions
\documentclass[10pt,twocolumn]{article}

%Paquets d'idioma i codificació de caràcters
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[catalan]{babel}

%Paquets d'escriptura matemàtica
\usepackage{amsmath,amsfonts,amssymb,amsthm}

%Definicions,exemples,observacions...
\newtheorem{def:}{{\color{green}$\blacksquare$} Definició}
\newtheorem{ex:}{{\color{blue}$\blacksquare$} Exemple}
\newtheorem{obs:}{{\color{olive}$\blacksquare$} Observació}
\newtheorem{prop:}{{\color{orange} $\blacksquare$} Proposició}
\newtheorem{th:}{{\color{red}$\blacksquare$} Teorema}
\newtheorem{col:}{{\color{green}$\blacksquare$} Corol·lari}
\newtheorem{not:}{{\color{black}$\blacksquare$} Notació} 

%Modificacions i noves comandes
\newcommand{\C}{\ensuremath{\mathbb{C}}}
\newcommand{\R}{\ensuremath{\mathbb{R}}}
\newcommand{\Q}{\ensuremath{\mathbb{Q}}}
\newcommand{\Z}{\ensuremath{\mathbb{Z}}}
\newcommand{\N}{\ensuremath{\mathbb{N}}}
\newcommand{\B}{\ensuremath{\mathcal{B}}}
\newcommand{\esp}{\text{ }}

%Canviem el símbol de demostració final  de un quadrat en blanc a QED 
\renewcommand\qedsymbol{QED} 
%Serveix per recordar alguna cosa que s'ha de fer però en el moment fa mandrà
\newcommand{\nehh}[1]{\color{magenta} (* {#1} *) \normalcolor }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                                              %%%
%%%                   %Altres paquets%                           %%%
%%%                                                              %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%Serveix per tenir més colors disponibles
\usepackage[svgnames]{xcolor}

%Serveix per agrupar files i columnes
\usepackage{multirow} 

%Serveix per introduir imatges
\usepackage{graphicx}

%Serveix per ficar url's 
\usepackage{url}

%Serveix per que totes les referències que apareguin en el document pdf clicant-hi amb el ratolí, el visor pdf saltarà a la posició referenciada
\usepackage{hyperref} 

%Serveix per ampliar les possibilitats dels entorns de llistes
\usepackage{enumerate,paralist}

%Serveix per poder generat subfigures.
\usepackage{subfigure} 

%Paquets per a dibuixos amb GeoGebra
\usepackage{pstricks-add} 

%Serveix taxar coses bé com per exemple $\longrightarrow$ i $\exists$
\usepackage{centernot} 

%Serveix per ficar colors a les taules
\usepackage{colortbl} 

%Serveix per fer el estil de capselera
\usepackage{fancyhdr}

%Serveix per fotre coses a dalt i a baix
\usepackage{stackrel} 

%Serveix per afegir poemes \begin{poem}
\usepackage{poemscol} 

% Serveix per ficar caixes
\usepackage{tcolorbox}
\usepackage{wasysym}

% Serveix per ficar lletres d'un alfafet 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                                              %%%
%%%                   %Utilitats visuals%                        %%%
%%%                                                              %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%Dades pael títol del nostre document
\title{\emph{\color{redviolet!75!black}Pla Docent {(PD)}}}
\author{ Taller de modelització \\ 2n. Grau en  Matemàtiques \\ Universitat Autònoma de Barcelona \\ Equip 15 \\ { \color{gray!3} Albert Acebrón i Marc Graells} }
\date{Versió: \today}

%Serveix per peus de pàgina i més
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE,RO]{Pla Docent}
\fancyhead[RE,LO]{\thepage}
\fancyfoot[CE,CO]{\slshape\nouppercase{\leftmark}}
\fancyfoot[LE,RO]{\thepage}
\renewcommand{\headrulewidth}{2pt}
\renewcommand{\footrulewidth}{1pt}

%Serveix perquè el nombre de secció sigui més bonic.
\def\thesection{\textbf{$\mathit{\arabic{section}}$}}
\setcounter{section}{-1}

%Serveix per lletra inicial més elegant i vanitosa 
\usepackage{erewhon}
\usepackage{lipsum}
\usepackage{lettrine}
\usepackage{GoudyIn}
\definecolor{redviolet}{RGB}{52,47,75}
\usepackage{xcolor} 
\renewcommand{\LettrineFontHook}{\color{redviolet}\GoudyInfamily{}}
\setcounter{DefaultLines}{3}%
\usepackage{listings}
\usepackage{yhmath}
\renewcommand{\abstractname}{\textbf{A}bstract}
\renewcommand{\abstract}{\textbf{A}bstract}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5


\usepackage{tikz}
\usepackage{varwidth}
\usepackage{linegoal}
\usepackage[explicit]{titlesec}
\usepackage[margin=1.5cm]{geometry}
\usepackage[Lenny]{fncychap}
\ChNameVar{\fontsize{14}{16}\usefont{OT1}{phv}{m}{n}\selectfont}
\ChNumVar{\fontsize{60}{62}\usefont{OT1}{ptm}{m}{n}\selectfont}
\ChTitleVar{\Huge\bfseries\rm}
\ChRuleWidth{1pt}
\newcommand{\cod}[1]{{ \color{redviolet}\texttt{#1}}}
\newtcolorbox{box1}[1]{
	colback=gray!5!white,
	colframe=gray!75!black,
	title={\Large #1}
}
\newtcolorbox{box2}[1]{
	colback=gray!5!white,
	colframe=redviolet!75!black,
	title={\Large #1}
}
\usepackage[nameinlink, capitalise, noabbrev]{cleveref}
\begin{document}
	
\maketitle
{
\centering
\begin{abstract}
	
\end{abstract}
}
\newpage
$$
\esp
$$
\\ 
\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                 %%
%    #-1        Portada TickZ i Abstract          %%
%                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\tableofcontents
\vspace{5mm}
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                 %%
%    #00        Introdució/comentari/\cdots       %%
%                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tcolorbox}[colframe=white,colback=redviolet!20,sharp corners=all,size=minimal,halign=center,valign=center]
	\section{\textit{Comentari per a la lectura}}
\end{tcolorbox}
\lettrine{D}onades les  diverses idees  que hem obtingut al llarg de les sessions de treball hem estructurat el treball de tal forma que cada secció tingui un cert grau \textit{d'independència} respecte les altres. Això es veu reflectit en el fet de que cada secció té les seves pròpies conclusions. Tot i poder fer-se una lectura permutada de les seccions recomanem l'ordre facilitat. 
\\ 
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                 %%
%    #01        Estudi del Enunciat               %%
%                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tcolorbox}[colframe=white,colback=redviolet!20,sharp corners=all,size=minimal,halign=center,valign=center]
\section{Anàlisis del problema}
\end{tcolorbox}
\lettrine{F}em una lectura de l'enunciat que descriu el problema plantejat. 

\vspace{5mm}

\begin{tcolorbox}[colback=black!1,title=\textbf{Enunciat del problema},coltitle=black,colbacktitle=black!10]
\textit{
Un departament d'una universitat té diferents tasques docents assignades, que s'han de repartir entre els seus professors. Actualment es distribueixen segons les hores de classe de cada tasca. Se suposa que el nombre d'hores mesura l'esforç associat a una tasca, però en la pràctica això no és prou realista, la qual cosa genera desequilibris. Es tracta de trobar un mètode més equilibrat per valorar les tasques docents, que tingui en compte la demanda per cada tasca per part dels diferents professors. Es podria expressar aquesta demanda a través d'una mena de subhasta. S'haurien de tenir en compte algunes restriccions, com per exemple, que tothom faci la mateixa quantitat de docència o la restricció que hi hagi a cada departament.
}
\end{tcolorbox}
Influenciats per la lectura de \cite{tah} indexem l'enunciat de forma conceptual mitjançant colors i nombres\footnote{Únicament com a eina visual, eliminant la seva possible ambigüitat amb nombres enters}. Alternem el color de la font per facilitar la lectura. 
\vspace{3mm}

\begin{tcolorbox}[colback=black!1,title=\textbf{Enunciat del problema},coltitle=black,colbacktitle=black!10]

\textit{{\color{cyan!60}$\blacksquare$}$^{(01)}${\color{black!80}Un departament d'una universitat té diferents tasques docents assignades, que s'han de repartir entre els seus professors.}}
 
\textit{{\color{blue!60}$\blacksquare$}$^{(02)}$ Actualment es distribueixen segons les hores de classe de cada tasca. Se suposa que el nombre d'hores mesura l'esforç associat a una tasca, però en la pràctica això no és prou realista, la qual cosa genera desequilibris.}

\textit{{\color{green!60}$\blacksquare$}$^{(03)}$ {\color{black!80}Es tracta de trobar un mètode més equilibrat per valorar les tasques docents, que tingui en compte la demanda de cada tasca per part dels diferents professors.}}
 
\textit{{\color{purple!60}$\blacksquare$}$^{(04)}$Es podria expressar aquesta demanda a través d'una mena de subhasta.}
 
\textit{{\color{violet!60}$\blacksquare$}$^{(05)}${\color{black!80}S'haurien de tenir en compte algunes restriccions, com per exemple, que tothom faci la mateixa quantitat de docència o la restricció que hi hagi a cada departament.}}

\end{tcolorbox}
Fem  l'anàlisi o interpretació per blocs, mantenint el mateix codi d'indexació. Les paraules en negreta únicament tenen la finalitat de recordar els tecnicismes d' \textit{investigació operativa} que ens faciliten l'abstracció del problema plantejat per l'enunciat.
\begin{itemize}
\item[{ \color{cyan!60} \underline{\underline{\normalcolor (01)}}}] El problema abstracte consisteix en una tasca de repartiment o assignació. Concretament, les tasques docents són els \textbf{objectes a repartir} entre  el professorat, cada possible assignació s'anomenarà \textbf{pla docent} o \textbf{solució} de forma anàloga en funció del context.\\
\item[{ \color{blue!60} \underline{\underline{\normalcolor (02)}}}] Acceptem que el \textit{Model actual} genera solucions \textbf{subòptimes} i ho  justificarem amb els mateixos arguments de l'enunciat.\\
\item[{ \color{green!60} \underline{\underline{\normalcolor (03)}}}] Es requereix un { \color{green!60} \underline{\normalcolor mètode}} per { \color{green!60} \underline{\normalcolor valorar}} i { \color{green!60} \underline{\normalcolor repartir}} les tasques docents en funció de la demanda del professorat. Aquest model ha de poder aportar una solució millor \footnote{Equivalentment, menys desequilibrada.}. 
\item[{ \color{purple!60} \underline{\underline{\normalcolor (04)}}}] Es proposa com a \textbf{alternativa}  desenvolupar un  { \color{purple!60} \underline{\normalcolor mètode basat en subhasta}}.
\item[{ \color{violet!60} \underline{\underline{\normalcolor (05)}}}] S'expressa anticipadament que el \textbf{model/mètode} ha de tenir \textbf{restriccions}  i se n'expliciten dues de necessàries: el volum del treball ha de ser \textit{homogeni}\footnote{Entesa com la qualitat de quantitat de docències semblants entre el professorat} i el mètode ha de contemplar la possibilitat de restriccions pròpies del departament. 
\end{itemize}
Analitzat i desglossat l'enunciat, passem a concretar o tipificar els objectius del treball.
\begin{tcolorbox}[colback=black!1,title=\textbf{0bjectius},coltitle=black,colbacktitle=black!10]
	\begin{enumerate}
	\item Elaborar \textbf{Mètode} per generar plans docents universitaris{\color{cyan!80} $^{(01)}$}. Aquest estarà basat en un repartiment de les tasques docents multivariable (dependrà de més d'una \textbf{variable decidible}) per a mesurar l'esforç{\color{blue!80} $^{(02)}$}{\color{green!80} $^{(03)}$} de cada tasca. El mètode haurà d'evitar desequilibris tipificats{\color{blue!80} $^{(02)}$}(documentats o previsibles) i estarà subjecte a un volum de \textbf{restriccions}{\color{violet!60} $^{(05)}$} variables. El mètode serà estructurat en base a la demanada del professorat com és requereix.
	\item S'estudiara la idea de fer un model basat en  subhastes.{\color{purple!80} $^{(04)}$} 
	\item S'aplicarà el mètode en un cas concret per tal de comprovar la seva viabilitat d'implementació  i competència. El cas concret serà el \textit{Departament de Matemàtiques} de la pròpia Universitat Autònoma de Barcelona.
	\end{enumerate}
\end{tcolorbox}
\vspace{5mm}
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                 %%
%    #02        Estudi del Model Actual           %%
%                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tcolorbox}[colframe=white,colback=redviolet!20,sharp corners=all,size=minimal,halign=center,valign=center]
\section{Estudi del model Actual}
\end{tcolorbox}
\lettrine{E}n aquesta secció analitzarem el mètode amb el qual  es reparteixen actualment les tasques docents entre el professorat del Departament de Matemàtiques de la universitat,  gràcies a les dades facilitades per aquest. Repetidament fem i farem servir el nom de \textit{Model actual}  per referir-nos a  aquest model o mètode.

Els objectius de la secció a  part d'obtenir una visió aproximada del \textit{cas particular} de major interès, tenen la intenció d'extreure i prendre constància dels desequilibris i restriccions, de la secció anterior,({\color{blue!60}$\blacksquare$}$^{(02)}$) i ({\color{violet!60}$\blacksquare$}$^{(05)}$)  respectivament. 
\\

\subsection{Dades obtingudes de la Web del Departament}
Algunes de les dades del model actual les podem trobar a la \textit{pàgina web} del Departament \cite{webdep}.

\vspace{3mm}

\begin{tcolorbox}[colback=black!1,title=\textbf{Dades públiques a la web},coltitle=black,colbacktitle=black!10]
\textbf{Docència de Grau}\\
El Departament de Matemàtiques és responsable principal de tres graus:
	\begin{enumerate}
		\item Grau de Matemàtiques
		\item Grau d'Estadística Aplicada
		\item Grau de Matemàtica Computacional i Analítica de Dades
		\item A banda, el Departament té assignada docència de gran varietat d'assignatures de vint-i-sis titulacions diferents.
	\end{enumerate}
	\textbf{Estructura}\\
	El Departament està constituït per cinc unitats, que es corresponen amb les àrees de coneixement que té adscrites:
	\begin{enumerate}
		\item Àlgebra
		\item Anàlisi Matemàtica
		\item Estadística i Investigació Operativa
		\item Geometria i Topologia
		\item Matemàtica Aplicada
	\end{enumerate}
\end{tcolorbox}
	%\url{https://www.uab.cat/web/departament-de-matematiques\\-1194422425366.html}
	%\end{box2}
	%\begin{box1}{Model actual {\footnotesize (A.Ruiz)}}
\subsection{Dades facilitades pel Secretari del Departament}\footnote{Actualment, càrrec ocupat pel Doctor Albert Ruiz Cirera.}
Donat que les dades públiques de la web són limitades i insuficients, per tal de tenir un primer contacte amb el \textit{problema}, s'ens ofereix la possibilitat de concretar una entrevista amb l'actual secretari del departament. D'aquesta obtenim un nou esquema que resumeix prou bé els objectius que ha de fer front el mètode objectiu del treball.
\vspace{3mm}

\begin{tcolorbox}[colback=black!1,title=\textbf{Dades del funcionament intern del \textit{model actual}},coltitle=black,colbacktitle=black!10]
	\textbf{Titulacions que demanen docència}
	\begin{itemize}
		\item Horari fixat
		\item Nombre d'alumnes fixat.
		\item Hores i tipologia fixada (classes de teoria, classes de problemes o seminaris).
	\end{itemize}
	En total es fa front a  unes 500 sol·licituds $\approx$ 150 assignatures. Típicament cada assignatura representa a la setmana 3 hores de teoria, 1 hora de problemes i 2 hores seminaris.
	\vspace{2mm}
	\\
	\textbf{Professorat}
	\\
	La quantitat de docència a impartir és diferent per cada professor, però oscil·la entre 90 i 240 hores l'any. A més a més, als estudiants de doctorat se'ls ofereix donar fins a 60 hores anuals de classes relacionades amb la temàtica del seu treball (però no els considerarem). Podem estimar que hi ha uns 100 professors.
	\vspace{2mm}
\\
	\textbf{Algunes de les normes que s'apliquen}
	\begin{itemize}
		\item Si un professor ha fet una assignatura un any, té preferència per repetir-la.
		\item Un professor/a pot impartir fins a 3 anys seguits com a màxim en les assignatures dels graus propis.
		\item En les matèries de les altres titulacions, màxim 4 anys consecutius.
		\item També hi ha altres càrrecs a realitzar en el departament que no impliquen docència.
	\end{itemize}
	\textbf{Actualment s'intenta minimitzar}
	\begin{itemize}
		\item Dispersió: \# assignatures / professor. (\#1)
		\item Deute personal (saldo en hores). (\#2)
	\end{itemize}
	\end{tcolorbox}

	\subsection{Altres notes del \textit{Model actual}}
	\begin{enumerate}
		\item Primer es fa una ronda de repartiment amb el professorat que té preferència (perquè repeteixen una assignatura). Després es fa una segona ronda amb les matèries restants, tot i que sovint hi ha canvis d'ultim moment. En aquesta segona ronda  és on es fa un tractament més personal i més precís. 
		\item En aquesta segona \textit{ronda} hi ha una llista d' \textit{argument} que ajuden a seleccionar el millor repartiment, vegem-ne alguns exemples:
		\begin{enumerate}
			\item Que tots els professors puguin fer almenys alguna hora de teoria (en general compten més i són més valorades).
			\item Suposant que hi ha una assignatura molt desitjada de teoria, probablement s'assignarà a algú que tingui un saldo d'hores negatiu abans que a algú que tingui un saldo positiu (que tingui acumulades més hores de les que ha de fer). Però també pot passar que entre dos sol·licitants s'assigni a qui fagi quadrar més els saldos, per exemple, si dos professors pugen per una matèria de 20 hores, i el saldo d'un és $S(p_1)=-30$ i el de l'altre  $S(p_2)=-5$, s'assignaria preferentment al primer.
			\item Aquestes estratègies busquen minimitzar (\#1) i (\#2) i a més tenir el personal \textit{content}, que és una cosa molt difícil de modelitzar, però també és important.
			\item S'intenta que els alumnes de doctorat puguin fer unes poques hores d'alguna matèria que estigui relacionada amb el seu treball.
		\end{enumerate} 
		\item Hi ha normes prou bones que queden \textit{implícites} en el mateix model. Pel que fa a les assignatures de 3r i 4rt  també tenen un filtre:
		\begin{enumerate}
	\item  Cada subdepartament només pot fer assignatures del bloc que li pertoca. En el cas que es vulgués impartir alguna matèria d'una altra \textit{branca de coneixement}, hauria de ser convidat pel subdepartament responsable.
	\item És a dir, cada subdepartament té un \textit{mercat d'assignatures associat} que s'han de repartir en una \textit{Reunió}. (Això dóna una bona idea, ja que així si més gent està implicada en el repartiment és pot considerar un model gran format de petits models \textit{més tractables} que interactuen \textit{poc} entre si).
			\end{enumerate}
		\end{enumerate}
\subsection{Estat del model actual}
Des del propi Departament de matemàtiques se'ns han facilitat dades anònimes\footnote{Per consultar-les vegeu el document \cod{pla\_docent.ods}.} que ens permeten calcular el saldo actual dels professors respecte aquest curs (2018/2019). 
\begin{itemize}
	\item Nombre d'hores que ha de fer cada professor del departament en un any.$\quad(p_i, \esp i \in I)$
	\item Nombre d'hores que fa realment un professor per a cada assignatura que se li ha assignat en el repartiment. $\quad (p'_i, \esp i \in I)$
\end{itemize}
El nostre objectiu és extreure del document tota la informació rellevant  mitjançant eines informàtiques elementals, com la programació en suite ofimàtica \textit{Excel}  per tal de donar una \textit{radiografia} del \textbf{model actual}. Per exemple, ens interessarà, obtenir la diferencia entre les hores que hauria de fer un professor i les hores que realment fa, és a dir, el \textit{saldo} \footnote{Dada molt rellevant del \textbf{model actual}.} del professor $i\in I$; $D_i:=p'_i-p_i$.

El \textit{saldo} pot prendre valors tan positius com negatius. En cas de que un professor fes més hores, el resultat  serà positiu (en hores) $D_i>0$. En cas contrari, és a dir, $D_i<0$ , obtindrem un resultat negatiu, indicant així, que el professor no arriba al nombre d'hores que ha de fer. També voldrem saber totes les hores que s'estan fent de forma \textit{extra} i totes les que no s'arriben a fer.  També sumarem aquests dos valors per obtenir el saldo total.\footnote{Per veure/consultar les dades recomanem visitar el fitxer \cod{saldo.c.}}

Els resultats més rellevants com a valors numèrics són:
\begin{itemize}
	\item El $\sum$ de saldos positius és \texttt{1793} hores.	
	\item El $\sum$ de saldos negatius és \texttt{-2671.0} hores.	
	\item El $\sum$ de saldos positius i negatius  és \texttt{-1122} hores, que és un \texttt{\textbf{8.968825 \%}} del nombre d'hores total que haurien de fer tots els professors.
	\item La mitjana aritmètica d' assignatures que fa cada professor és de $\approx 5. \wideparen{972}$.
	\item Variància: 737.0676, Suma absoluta: 2498. (Veure Figures 1 i 2)
\end{itemize}
Es fa evident doncs que el model és propens a reduir el nombre d'hores que s'haurien de fer i observant els resultats professor a professor veiem que hi han diferencies de fins a 80 hores de saldo negatiu o casos on el saldo positiu ascendeix fins a 62.
\begin{figure}
\centering
\includegraphics[width=9cm]{D_ma}
\caption{Saldos \texttt{TOTAL} actual del professorat any 2018}
\label{fig:1}
\end{figure}
\begin{figure}
	\centering
	\includegraphics[width=9cm]{dis_ma}
	\caption{Dispersió \texttt{TOTAL} actual del professorat any 2018}
	\label{fig:2}
\end{figure}
\subsection{Conclusions}
		\begin{enumerate}
		    \item La variància del \textit{Saldo} sembla ser \textit{millorable}.
			\item El model actual funciona prou bé, fixa normes generals i fa un tractament diferent per cada cas, aconseguint més satisfacció en les assignacions. Per tant podem aprofitar molt del model actual. 
			\item Les particularitats \textit{bones} del model, entre altres, són el tractament prou adaptable a la \textit{diversitat} del professorat.
			\item Els aspectes negatius del model no són clars llevat de la \textit{alta} dedicació que requereix. La necessitat d' un temps de dedicació considerable per fer quadrar totes les assignacions satisfactòriament potser sembla ser un preu \textit{massa alt}.
			\item No analitzem la satisfacció del professorat amb el model actual, però la considerem \textit{ la millor} fins el moment. 
		\end{enumerate}
\newpage
$\esp$
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                   Model d'optimització o        %%
%    #03                                          %%
%                 investigació Operativa          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tcolorbox}[colframe=white,colback=redviolet!20,sharp corners=all,size=minimal,halign=center,valign=center]
\section{Model d'Optimització o d'investigació operativa}
\end{tcolorbox}
\lettrine{U}na altra forma d'abordar el problema és començar definint què és una \textbf{alternativa bona}, donant una mesura explícita de com de bona és una \textbf{alternativa}, és a dir, com de satisfactòria és una assignació d'assignatures entre el professorat.

Fins ara s'utilitzava una mesura no definida basada en el \textit{coneixement implícit} del sistema que tenia el professor que realitzava l'assignació. Donat $I$ el conjunt finit de professors i $o \in N$ el nombre d'assignatures que s'han de distribuir, definim la mesura mencionada com una funció:

$$F: I^o \longrightarrow \R$$

tal que com \textit{més baix} sigui $F(a)$ (donat $a \in I^o$) millor serà l'alternativa $a$.

Un cop haguem trobat una funció que compleixi això, trobar una alternativa bona passarà a ser un problema d'optimització, el qual tractarem amb una filosofia \textbf{heurística} a la secció 3.2 (Optimització).

És a dir, farem servir la \textit{típica estratègia} elemental d' investigació d'operacions:
\vspace{3 mm}

\begin{tcolorbox}
	\texttt{\textbf{maximitzar} o \textbf{minimitzar}} \texttt{F}
	\\ 
	\texttt{Subjecte a:}
	\\
	\text{ } \hspace{10mm} \texttt{\textbf{restriccions}}
\end{tcolorbox}
En aquest cas, \textbf{minimitzarem} la funció $F$ encara a definir.
\vspace{3mm}

\subsection{Definició o Ontologia de la funció objectiu}
Determinar la \textbf{funció objectiu} resulta inevitablement difícil, ja que aquesta està lligada al criteri subjectiu de cada professor. Malgrat això, podem aplicar diverses \textbf{restriccions} sobre les  \textbf{alternatives} que estan \textit{prohibides} pel sistema (com per exemple: un professor assignat a dos classes que es realitzin simultàniament), de manera que ens aquests casos la funció donarà infinit o bé els descartara. En els altres casos, en els que hem de determinar la qualitat d'una \textbf{alternativa factible} ens trobem amb l'ambigüitat que havíem comentat anteriorment, ja que per cada professor, aquesta funció seria diferent i hem de balancejar els desitjos d'uns professors amb els dels altres, ja que en molts casos ens trobarem que una \textbf{alternativa} que és \textit{millor} per a uns, és \textit{pitjor} pels altres. Hi ha diverses possibles sortides a aquesta problemàtica:
\begin{enumerate}
	\item \textbf{Basar-nos en dades Històriques} fent un recull del \textit{historial}  d'alternatives prèvies, juntament amb les dades base que es van utilitzar per crear-les, podem intentar trobar la \textbf{funció implícita} que es va utilitzar per \textit{avaluar} les \textbf{alternatives}. És a dir, buscar, utilitzant aproximacions de funcions, una funció sobre les \textbf{dades base} \footnote{De nou aquestes estarien basades en l'historial recuperable, d'almenys, cinc anys enrere.} tal que, al optimitzar-la sobre cada un dels conjunts de dades base de cada any, doni una \textbf{alternativa} el més semblant possible a la solució que es va utilitzar aquell any. Aquesta opció és descarta amb l'argument que aquest criteris poden variar \textit{molt} en funció del temps.
	\item \textbf{Obtenció de dades mitjançant enquesta} preguntant als professors directament què valoren més i creant una funció de forma artesanal basant-nos en els resultats. L'argument per menysprear part d'aquesta font  per seleccionar els criteris resideix en que, pot haver interès en mentir a aquestes respostes per afavorir \textit{possibles} \textbf{estratègies guanyadores}.
	\item \textbf{Funcions personalitzables} a nivell individual per cada professor. A partir d'aquestes funcions individuals podem crear una funció global que estigui formada per un sumatori d'aquestes funcions tal que al optimitzar aquesta funció global estarem optimitzant les funcions individuals en conjunt. Això a la pràctica és pot traduir en contemplar tots els criteris a la vegada i en cas de que un criteri estigues més present augmentar-ne el \textit{pes} en la \textbf{funció objectiu} $F$.
\end{enumerate} 
\begin{figure}
	\centering
	\includegraphics[width=9cm]{algor_bl}
	\caption{ \footnotesize Esquema que il·lustra les diferents \textit{vies} que és podrien considerar a l'hora de concretar aquesta funció $F$ que valores \textit{com de bona}  és una assignació d'assignatures entre el professorat. El \textit{hexàgon irregular}   (en un color més clar) representa un algoritme d'optimització concret. Simulated annealing, o de forma abreujada (SA), té origen en l'industria metal·lúrgica i està pensat per buscar \textbf{solucions optimes} en \textit{espais de cerca} grans. La seva presencia és \textit{oportunista} però no compromet la idea general ja que podríem encaixar, en el mateix esquema, qualsevol altre algorisme d'optimització, cosa que farem en la subsecció 3.5 ( resultats del model).}
	\label{fig:4}
\end{figure}
A la figura \ref{fig:4} observem un esquema que il·lustra la problemàtica i els tres punts esmentats on  l'\textit{idea clau} és respondre la pregunta.
\vspace{1mm}

\textit{Com justifiquem que els criteris que fixem i definiran la funció són bons o es corresponen amb el desig del professorat ?} 
 
\vspace{1mm}
En el nostre cas \textit{apostem} per un \textit{mix} entre el punt 2 i 3. Personalització limitada per \textbf{restriccions}, però adaptable a les \textit{particularitats} del Departament i les \textit{preferències}. La idea és facilitar una \textit{Biblioteca} de funcions per definir la funció final $F$ com a la suma d'una selecció d'aquestes.

\subsection{Ventall de criteris i Biblioteca de \textit{subfuncions}}
Definirem de forma additiva la funció $F$, és a dir, direm com es pot construir a partir d'altres \textit{subfuncions} i perquè ho fem així. Amb notació anterior tenim:

$$
\begin{matrix}
F: I^o \longrightarrow \R \qquad \quad  \\
a\longmapsto \displaystyle \sum_{i=1}^{k}f_i(a) \\
\end{matrix}
$$
On cada $f_i$ representa un \textit{criteri matematitzat} que  valora un aspecte concret. D'aquesta manera podem fer que la funció tingui en compte tants criteris com vulguem i que el fet de \textit{suprimir-ne} un  o \textit{afegir-ne} un altre no impliqui definir de nou la funció.
Això respon \textit{fortament} a {\color{violet!60}$\blacksquare$}$^{(05)}$.

La pregunta ara doncs és: \textit{Quina mena de funcions podem donar ?} De fet aquesta pregunta és massa ambiciosa, però donem alguns dels exemples de funcions que hem vist \textit{raonables} i \textit{interessants}, que a més poden facilitar la tasca. De fet d'ara en endavant ens referirem a un conjunt de \textbf{subfuncions} concretes com a \textbf{Biblioteca}.
\vspace{3mm}

\begin{itemize}[$\RHD$]
	\item \begin{tabular}{|c|m{50mm}|}
		\hline
		\textbf{Criteri (B:1):}& Moderar el nombre d'assignatures  per professor.\\
		\hline
		\textbf{Funció (B:1):}& $\begin{matrix} \\ f_1(x)=x^3 \\ \\ \end{matrix}$\\
		\hline
		\textbf{Comentari (B:1):}& Aconseguir minimitzar el nombre d'assignatures que fa cada professor. Si volem ficar més pes només hem d'augmentar el grau del \textit{monomi}.\\
		\hline
	\end{tabular}
   \vspace{3mm}
    \includegraphics[width=8.5cm]{asig_mf}
    \\ 
    {
    \textbf{Figura (B:1):} 
    {\footnotesize Gràfic de la funció $f_1(x)=x^3$.}}
\vspace{3mm}
\item 
\begin{tabular}{|c|m{5cm}|}
	\hline
	\textbf{Criteri (B:2):}& Limitar el nombre d'hores de classe per dia.\\
	\hline
	\textbf{Funció (B:2):}& \footnotesize $\begin{matrix} \\ f_2(x):=\left\lbrace 
	\begin{matrix}
		(x-500)^2& \text{ si}& x>500\text{ ,} \\
		0& \text{ si}& x\leq 500& \end{matrix}
	\right.\\ \\ \end{matrix}$\\
	\hline
	\textbf{Comentari (B:2):}& La funció a trossos contínua penalitza \textit{fortament} qualsevol assignació que faci que un docent hagi de fer més de 500 min de classe en un dia. \\
	\hline
\end{tabular}
\includegraphics[width=8.5cm]{timeday_mf}
\\ 
{
	\textbf{Figura (B:2):} 
	{\footnotesize Gràfic de la funció  $f_2(x):=\left\lbrace 
		\begin{matrix}
			(x-500)^2 \text{ si } x>500\text{ ,} \\
			0  \qquad \qquad \text{ si } x\leq 500\end{matrix}
		\right.\\ $.}}
\item \begin{tabular}{|c|m{50mm}|}
	\hline
	\textbf{Criteri (B:3):}& Moderar els saldos molt alts en valor absolut.\\
	\hline
	\textbf{Funció (B:3):}& $\begin{matrix} \\ f_3(x)=x^2 \\ \\ \end{matrix}$ \\
	\hline
	\textbf{Comentari (B:3):}& Agafant la noció de \textit{saldo} del \textbf{model actual}. La idea és aconseguir que no hi hagi saldos molt \textit{grans}, ja que d'aquesta forma aconseguim adequar les hores que ha de fer cada professor o professora a la llarga. També evitem la acumulació de \textit{deutes} que a la llarga serien \textit{insalvables}.\\
	\hline
\end{tabular}
    \includegraphics[width=8.5cm]{D_mf}
    \\ 
    {
	\textbf{Figura (B:3):} 
	{\footnotesize Gràfic de la funció $f_3(x)=x^2$.}}
\\
\includegraphics[width=8.5cm]{inter_mf} 
{\textbf{Diagrama (B:4):} {\footnotesize Diagrama que il·lustra  la distància \textit{en temps} entre les hores de classe de diferents docents (cada color representa un docent) on les fletxes (en el mateix color, diferent per cada docent) il·lustren la distància entre les assignatures que han d'impartir  en diferents dies d'una setmana.}}
\item \begin{tabular}{|c|m{50mm}|}
	\hline
	\textbf{Criteri (B:4):}& Temps entre classes \textit{desagradables} o \textit{inviables}.\\
	\hline
	\textbf{Funció (B:4):}& \footnotesize
	 $\esp$
	 
	 $f_4(x):=$
	 
	 $\esp$
	 
	 
	$\begin{cases}
    \left(2\cdot(15-x)\right)^2 &\text{ si } 0 \leq x \leq 15 \\
     x-15 &\text{ si } 15 \leq x \leq 300\\
     30\log{\left(\cfrac{x}{300}\right)}+285 &\text{ si } 300 \leq x \\ 
      \end{cases}$
      
      $\esp$
	\\ 
\hline
	\textbf{Comentari (B:4):}& Aquest \textit{subfunció}  definida a trossos evita  temps \textit{inviables} entre classe. Com per exemple: acabar una classe i començar la següent de forma \textit{instantània} (Aquest seria l'us \textit{ics} quadrat); o bé temps molt distants (Evitant així casos com tenir  únicament dues assignatures  en un mateix dia separades potser per 5 hores $\approx 300 \esp min$).\\
	\hline
\end{tabular}
\includegraphics[width=8.5cm]{interc_mf}
\\ 
{
	\textbf{Figura (B:4):} 
	{\footnotesize Gràfic de la funció $f_4(x)$ definida a trossos.
		}}
\end{itemize}
\subsection{Optimització}
Optimitzar $F$ resulta un problema molt difícil, ja que tenim unes $\approx 100^{500}$ \textbf{alternatives} \footnote{Altrament $ \approx 10^{1000}$.} Inicialment vam utilitzar \textit{Simulated Annealing} (Algorisme d'Optimització apropiat per a grans \textbf{espais de cerca} ) amb control de mínims locals per tal d'optimitzar  la funció $F$ en un temps \textit{raonable}. Però, donada la \textit{filosofia} del treball, vam voler  optimitzar la \textbf{funció objectiu} de forma pròpia mitjançant \textbf{selecció d'algoritmes genètics}.   
\begin{enumerate}
	\item \textbf{Simulated Annealing:} Algorisme basat en el mètode de Montecarlo \textit{refinat}, és apropiat per \textbf{espais de cerca} grans. Té origen en una tècnica de l'industria metal·lúrgica i es sol aplicar en \textit{optimització} per cercar mínims i màxims d'una funció donada.
	\item \textbf{Algorisme genètic:} Els algoritmes genètics, els quals es basen en el procés evolutiu, de forma molt simplificada consisteixen en generar solucions per a un problema mitjançant la recombinació de solucions anteriors i l'aplicació de mutacions aleatories sobre la solució, per després evaluar les solucions obtingudes i elegir les millors, millorant respecte les \textit{solucions anteriors} i imitant així la \textit{selecció natural biològica}.
	\item \textbf{Altres algorismes meta-heurístics d'optimització de funcions no lineals:} També és podrien haver fet servir algorismes com:  
	\begin{enumerate}
		\item Optimització d'eixam de partícules
		\item Cerca de cucut
		\item Cerca de tabus
		\item Algorisme de cerca gravitativa
		\item Túnels estocàstics
		\item Optimització de colònies d’abelles artificials
		\item Recuit simulat
		\item Túnels estocàstics
	\end{enumerate}
\end{enumerate}
\subsection{Limitacions del model}
És clar que en primera instancia una estratègia prou pràctica com els \textit{algorismes} per optimitzar el model es podria tirar per terra argumentant que cap d'aquest mètodes (\textit{simulated annealing} i \textit{Algorismes genètics}) podran trobar el mínim absolut de la funció a optimitzar $F$. 

Un argument així no \textit{correspon} amb la \textit{filosofia del treball}. Això no ens resulta problemàtic, ja que només ens cal que la \textbf{solució} sigui \textit{bona}, entenent com a bon que sigui: \textbf{factible} , que consumeixi un temps \textit{raonable} en ser trobada i que sigui \textit{substancialment millor} que la del \textbf{model actual}. I això és pot comprovar fàcilment com farem en la subsecció 3.5 Resultats.

De fet només hem donat una \textit{definició constructiva}, és a dir, hem donat una \textit{idea} de com construir $F$, però no l'hem explicitat ja que la \textit{màgia} d'aquesta és que es pugui adaptar a \textbf{restriccions} i criteris (a partir els quals definir les esmentades \textit{subfuncions}) diferents. Cosa que respon \textit{fortament} a  {\color{green!60}$\blacksquare$}$^{(03)}$, {\color{cyan!60}$\blacksquare$}$^{(01)}$ i {\color{violet!60}$\blacksquare$}$^{(05)}$.
\subsection{Resultats del model}
Els resultats més rellevants d'aquest model són:
\begin{enumerate}
	\item Possibilitar la cerca de \textbf{solucions factibles}\footnote{Enteses com a assignacions que compleixen amb les \textbf{restriccions} imposades. }
	\item Possibilitat de millorar la \textbf{optimització} d'alguns aspectes del \textbf{model actual}.
\end{enumerate}
Comparant aquest model, \textbf{model d'investigacions operatives}, amb el \textbf{model actual} agafant com a \textbf{funció objectiu} :
$$
F=\sum_{i=1}^{2}(f_i)(a) 
$$
$$\text{ amb } \qquad f_1(a)=\sum_{j=1}^{111} (x_j-x'_j)^2 \qquad \text{ i }$$  
on $x_j$ serien les hores de classe que hauria de fer un professora o professor $j \in \{1,\cdots,111\}$ i $x_j'$ les hores que farà amb l'assignació $a$ el professor $j \in \{1,\cdots,111\}$ (Hi ha 111 professors).
$$\text{ amb }  \qquad f_2(a)=\sum_{j=1}^{111} (y_j)^3$$
on $y_j$ serien el nombre de matèries docents que hauria de fer un professor $j \in \{1,\cdots,111\}$   amb \textbf{alternativa} $a$. 

Això seria el que actualment s'intenta minimitzar. Programant en Python (amb els dos algorismes per \textit{minimitzar} $F$) obtenim els resultats que es veuen en les figures 4 i 5 (per el saldo); i 6 i 7 (pel nombre d'assignatures).
Resumint aquestes podem observar Taula 1. 
\vspace{3mm}

\begin{tcolorbox}[colback=white,coltitle=black,colframe=white, colback=white]
{\centering
	\small
	\begin{tabular}{|c|c|c|c|}
	\hline
     \textbf{Model}&\textbf{actual}&\textbf{$F$+(SA)}&\textbf{$F$+(GA)}\\
     \hline
     Variància&737'0676&14'7221&124'70397\\
     \hline
     Suma absoluta&2498&1156&1461\\
     \hline
	\end{tabular}
}
\end{tcolorbox}
\noindent \textbf{Taula 1:} \small{Suma del valor absolut dels saldos dels professors  i la seva variància, tant del \textit{model actual} (primera columna), com dels models d'optimització de $F$ tant amb \textit{Simulated annealing} (tercera columna) com amb \textit{Algorismes genètics} (quarta columna).}
\vspace{3mm}

\normalsize
Concloem doncs que els models d'optimització donen una \textbf{solució bona}. Es milloren els resultats del \textbf{model actual}.
	\begin{figure}[!]
		\centering
		\includegraphics[width=9cm]{sorted_mo}
		\caption{ \small Saldo \texttt{TOTAL}  del professorat en l'any 2018 amb ({\color{blue!70}$\blacksquare$}) \textit{model actual}  i ({\color{orange!70!red!90}$\blacksquare$}) \textit{model Optimització amb SA} (Simulated annealing). Cada columna representa el saldo d'un professor, les columnes han sigut ordenades de més petita a més gran tenint en compte el signe, respecte el \textit{model actual}. }
		\label{fig:6}
	\end{figure}
	\begin{figure}[!]
		\centering
		\includegraphics[width=9cm]{sorted2_mo}
		\caption{ \small Saldo \texttt{TOTAL}  del professorat en l'any 2018 amb ({\color{blue!70}$\blacksquare$}) \textit{model actual}  i ({\color{yellow!70!gray!90}$\blacksquare$}) \textit{model Optimització amb GA} (Algorismes genètics). Cada columna representa el saldo d'un professor, les columnes han sigut ordenades de més petita a més gran tenint en compte el signe, respecte el \textit{model actual}. }
		\label{fig:64}
	\end{figure}
	\begin{figure}[!]
		\centering
		\includegraphics[width=9cm]{disp_sorted_sa}
		\caption{ \small Nombre \textit{d'assignatures} que fa el professorat en l'any 2018 amb  ({\color{blue!70}$\blacksquare$}) \textit{model actual} i ({\color{orange!70!red!90}$\blacksquare$}) \textit{model Optimització amb SA} (Simulated annealing). Cada columna representa el nombre d'assignatures que fa un docent, les columnes han sigut ordenades de més petita a més gran tenint en compte el signe, respecte el \textit{model actual}. }
		\label{fig:sor}
	\end{figure}
	\begin{figure}[!]
		\centering
		\includegraphics[width=9cm]{disp_sorted_ga}
		\caption{ \small  Nombre \textit{d'assignatures} que fa el professorat en l'any 2018 amb  ({\color{blue!70}$\blacksquare$}) \textit{model actual} i ({\color{yellow!70!gray!90}$\blacksquare$}) \textit{model Optimització amb GA} (Algorismes genètics). Cada columna representa el nombre d'assignatures que fa un docent, les columnes han sigut ordenades de més petita a més gran tenint en compte el signe, respecte el \textit{model actual}. }
		\label{fig:sorted_mo}
	\end{figure}
\newpage
\subsection{Alguns detalls sobre el procés d'elaboració dels algoritmes genètics}
\normalsize
Com hem explicat a l'apartat 3.3, els algoritmes genètics generen possibles \textbf{solucions} a base de recombinar i mutar solucions ja existents\cite{ga}. Aquests mecanismes \textit{abstractes}, així com la codificació de la solució sobre la qual operen, admeten moltes possibles variacions, les quals s'han d'adaptar al problema per aconseguir el \textit{màxim rendiment}.

A més a més, el nostre algoritme utilitza \textbf{elitisme}, de manera que les millors solucions són conservades entre iteracions de l'algorisme, portant a que noves generacions sempre \textit{millorin} la funció de cost.

En la nostra implementació dels algoritmes genètics, hem optat per representar el \textbf{fenotip} (la codificació de cada solució generada) com una matriu de professors, on cada posició defineix quin professor es assignat a cada assignatura diferent. La \textbf{mutació} es implementada com una assignació d'una assignatura aleatòria a un professor aleatori; per altra part la recombinació crea noves solucions a partir de dos solucions triades aleatoriameant entre les millors (la \textbf{élit}), generant una nova solució que tingui part de les assignacions d'assigatures d'una i part de l'altra. Altres paràmetres, com la mida de la població, la probabilitat de recombinació o la de mutació, s'han triat de forme empírica a base d'executar l'algorisme i buscar les constants que donaven els millors resultats.

Comparant els resultats obtinguts en l'optimització en que hem utilitzat \textit{Simulated Annealing} i en la d'Algoritmes Genètics, és trivial veure que els resultats de SA són molt millors, ja que s'assoleixen assignacions amb diferències d'hores més ben distribuïdes. Aixó és així perquè hem executat els algoritmes durant poc temps (menys de 20 minuts) i el fet que les iteracions en GA són molt més lentes ha portat a que no s'aconseguís arribar a un mínim local.

Creiem que en executar l'algoritme durant períodes de temps més llargs, les capacitats per evitar mínims locals dels GAs mitjançant l'\textbf{especiació} portaran a una millora de resultats respecte al SA, ja que l'exploració realitzada pel GA cobrirà molt més \textbf{espai}.

\begin{figure}[!]
	\centering
	\includegraphics[width=9cm]{progress_ga}
	\caption{ \small Gràfica de l'evolució de la qualitat de la millor assignació de cada generació respecte al temps  acumulat d'execució de l'algorisme genètic.}
	\label{fio}
\end{figure}
\begin{figure}[ht]
	\centering
	\includegraphics[width=9cm]{recombinacio}
	\caption{ \small Diagrama que il·lustra l'aplicació de l'\textbf{operador} de recombinació. }
	\label{firo}
\end{figure}
\subsection{Revalorització d'assignatures}
Durant l'optimització, els \textbf{models d'optimització} ja revaloritzen les assignatures de forma intrínseca per tal d'aconseguir que la satisfacció de tots els professors sigui màxima. 

No obstant, ens interessa obtenir una valorització \textit{explícita}, ja que aquest és un dels requisits que ha de complir el model d'acord amb l'enunciat del treball (concretament {\color{green!60}$\blacksquare$}$^{(03)}$).

Per tal d'obtenir aquesta \textbf{valoració}, intentarem extreure'n aquesta de forma intrínseca quan es realitza l'optimització, basant-nos en una comparació entre l'avaluació de l'estat actual d'un professor i el de la resta de professors.

Així doncs, començarem separant l'avaluació de l'estat d'un professor del de la resta en la funció d'avaluació d'una assignació. Això ho podem fer perque totes les funcions que formen part d'aquesta funció d'avaluació, que realment és un sumatori de les primeres funcions, són independents entre elles i s'apliquen sobre només un professor. D'aquesta manera, dividim la funció d'avaluació:
$$F(a)= \displaystyle \sum_{p\in professors} \sum_{f_i\in funcions} f_i(p) = $$
$$= \displaystyle \sum_{p\in professors} f(p)$$
On és fàcil observar que:
$$f(p)=\sum_{i\in funcions} f_i(p)$$

A partir d'aquí podem aplicar $f$ sobre l'estat de tots els professors i obtenir la mitja $\mu$ i la desviació típica $\sigma$ de la distribució d'aquests valors. 

A continuació calculem els següents valors, que ens permeten obtenir una aproximació de com de bo és l'estat d'un professor respecte la resta. A més, al dividir per sigma, obtenim un \textbf{valor adimensional} que rectifica les unitats que estiguem utilitzant (de manera que utilitzar unitats amb valors molt grans o molt petits no afectarà funcionalment el resultat final) i ens normalitza el resultat respecte a la variancia de les dades, de manera que un resultat podrà ser molt alt només si es \textit{extremadament} diferent a la resta de dades.

$$\phi(p)=\dfrac{f(p)-\mu}{\sigma}$$

Finalment, revaloritzem les assignatures amb el següent càlcul:

$$h_{nou_a}=h_{vell_a}(1+\phi(p)\alpha) \quad \forall a \in A_p$$

on $A_p$ és el conjunt d'assignatures realitzades pel professor $p$, i $\alpha$ és un paràmetre constant modificable que serveix per a modificar la \textit{intensitat} de la revalorització per tal que s'adapti al funcionament esperat pels usuaris.
\subsection{Problemàtica típica de la \textit{subfuncions} personalitzables}

Una problemàtica que \textit{mereix la pena} ser tractar en detall, és el fet de les \textit{subfuncions} \textit{personalitzables problemàtiques}.

Imaginem que un docent \textit{amb certa mandrositat} decideix definir-se una \textbf{subfunció pròpia} que gairebé sempre retorna valors \textit{gegants} per  qualsevol assignació que se li dóna, llevat  potser que se li dones l'assignació de no impartir cap assignatura. És clar que si avaluéssim directament aquesta \textit{subfunció} la millor assignació per aquest professor seria impartir zero assignatures, cosa que no resulta \textit{massa interessant} pel model ni per la resta del professorat.

La solució que donem és prou senzilla però no per això menys \textit{bona}. Per cada funció donada per un professor $f_j(a)$ considerem:
$$
f_j'(a):=
\begin{cases}
f_j(a) &\text{ si } f_j(a)\leq K \text{ i}\\
K &\text{ si } K<f_j(a)\\
\end{cases}
$$
Llavors considerant $f_j'$ en comptes de $f_j$ ja tindríem el problema solucionat, ja que llavors tota \textbf{subfunció personalitzable} està fitada superiorment i el cas anterior no és pot donar. A més dòna incentius per no fer servir aquest tipus d'estrategies, ja que llavors molt probablement la optimització de $F$ acabi donant una \textbf{alternativa} $a$ prou dolenta pel \textit{picaresc docent}.
\newpage
$$
\esp
$$
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                 %%
%    #04    Models d'assignacions  per subhastes  %%
%                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tcolorbox}[colframe=white,colback=redviolet!20,sharp corners=all,size=minimal,halign=center,valign=center]
	\section{Models d'assignacions per subhastes}
\end{tcolorbox}
\lettrine{E}n aquesta secció abordarem la problemàtica d'assignacions mitjançant l'estructura de subhasta, pensant, com en les seccions anteriors, en la seva aplicació final. La intenció  és \textit{construir} un \textbf{mètode} sobre l'estructura de subhasta que permeti  donar solució al problema dels repartiments.
\subsection{Problemàtiques i beneficis de les subhastes}
Tots tenim una idea intuïtiva de subhasta. Més enllà de les conegudes subhastes d'\textit{eBay}\footnote{Aquest tipus s'anomenen subhastes angleses, que són subhastes on totes les puges són públiques i la puja més alta guanya, pagant el preu d'aquesta mateixa puja. }  ni'ha de molts altres tipus, que no només poden ser classificades per un únic criteri sinó per molts. Explicitem algunes d'aquestes classificacions.

Les \textbf{subhastes simultànies o paral·leles} són aquelles que és \textit{resolen} a la vegada, és a dir, només cal un \textit{instant} per determinar els guanyadors. Per conta les \textbf{subhastes seqüencials } són aquelles en que és decideixen \textit{una per una}. 

Les \textbf{subhastes a cegues} són aquelles en que les puges que fa cada participant de la subhasta no són públiques, en canvi, en les \textbf{subhastes públiques} sí.

Les \textbf{subhastes a l'alça} són aquelles en les qui guanya el participant que ofereix el major preu, en canvi les \textbf{subhastes a la baixa}, són guanyades pel participant que  ofereix el menor preu. Un exemple d'aquesta ultima podria ser el preu mínim que està disposat a rebré un \textit{participant} per realitzar una tasca.

L'objectiu principal de la majoria de \textbf{subhastes} és vendre \textit{objectes} al preu més alt possible (suposant que fossin subhastes a l'alça),és a dir, maximitzen el \textit{guany} del \textit{venedor}. En un cas com en el de repartir les assignatures entre el professorat del departament d'una facultat això no té sentit, ni és un bon plantejament, ja que no hi ha objectiu de guany, sinó únicament de repartiment.

Per tant una subhasta típica no seria pas una bona solució al problema de repartiment. No obstant hi ha un tipus de subhasta que no maximitza el benefici del \textit{venedor} sinó el dels \textit{participants}, és a dir, en maximitza \textbf{l'utilitat} d'aquests últims. 

Aquest tipus de subhasta, que de fet és l'única que farem servir tot i donar \textbf{quatre} models completament diferents basats en subhastes, es coneixen com a subhastes de \textbf{Vickrey}. Les \textbf{subhastes de Vickrey} són subhastes  seqüencials (per evitar \textit{bloqueig de moneda}) a a cegues on el guanyador d'una subhasta és qui ofereix el preu més alt (suposant subhastes a l'alça) pagant el preu de la segona puja més alta.

En \textbf{Teoria de jocs} es pot demostrar que aquests tipus de subhasta són totalment eficient, que tal com havíem dit abans maximitza l'\textbf{utilitat} dels participants i per tant incentiva a fer pugues \textit{racionals}, és a dir, pagar el que és creu correcte o \textit{just}.   

No obstant una implementació \textit{a priori} de subhastes de Vickrey, per obtenir una subhasta optima o satisfactòria, no podria ser pas factible  ja que no hauria de ser seqüencial ja que llavor l'experiència del usuari (UX) podria ser desagradable ja que cada \textit{assignatura} hauria d'estar activa en períodes de temps disjunts. A més si fos simultània també tindríem problemes, ja que llavors, podria haver problemes de \textbf{bloqueig de moneda}. Tal com il·lustra el Exemple \# 1. La Solució queda per subhastar blocs d'assignatures en períodes disjunts de temps.

\begin{tcolorbox}[colback=black!1,title=\textbf{Exemple \# 1},coltitle=black,colbacktitle=black!10]
\begin{itemize}
	\item En Grothendieck vol pujar per l'assignatura $A$, $B$, $C$.
	\item Ell té un total de 10 monedes.
	\item Puja 5 monedes per $A$, 3 monedes per $B$ i 2 monedes per $C$.
	\item Finalment totes les assignatures subhastades és venen per 6 monedes i en Grothendieck no en guanya cap.
	\item Si s'hagessin subhastat una per una, evidentment en Grothendieck hauria aconseguit com a mínim una en l'ultima puja, però no ha estat així  ja que les seves monedes estaven bloquejades per altres puges. \item Aquest fenomen es coneix com a \textbf{bloqueig de moneda}.
\end{itemize}
\end{tcolorbox}
\begin{figure}[!]
	\centering
	\includegraphics[width=9cm]{subs}
	\caption{ \footnotesize Diagram que il·lustra la problemàtica d'aplicar directament \textit{Subhastes de Vickrey} al problema plantejat.}
	\label{fig:4}
\end{figure}
\subsection{Un model minimalista, els \textit{Kiwis}}
\subsubsection{Repartiment kiwis}
Per a tal de fer més justa la repartició d'assignatures i de premiar l'esforç del professorat i la qualitat de la seva feina, proposem un model de subhastes on la moneda de canvi, els kiwis, siguin repartits entre els pujadors de la següent manera:

Cada professor parteix de 10 Kiwis.
Si el professor té acumulat un saldo positiu (ha fet més hores del que li pertoquen en els ultims 3 anys) se li sumen 5 Kiwis per cada 10 hores que tingui en el saldo : 
\begin{itemize}
	\item 5 Kiwis per un saldo de 0 a 10h
	\item 10 Kiwis per un saldo de 11 a 20h
	\item  Etc.
\end{itemize}
A partir del segon any de l'instauració d'aquest model, si el professor va haver de impartir $x$ matèries que no va triar (assignades mitjançant la funció després de fer totes les subhastes) se li sumaran $x$ Kiwis. A aquells professors que vagin aconseguir més d'un 4.5 de mitjana en les enquestes realitzades per l'alumnat l'any anterior,  se li sumaran 30 kiwis. 

\subsubsection{Funcionament subhasta}
Realitzarem una subhasta per blocs de matèries, cada professor omplirà les caselles de les matèries per les que vulgui pujar d'un pdf amb el valor en kiwis que està disposat  a pagar. El preu inicial de cada matèria és de 0 Kiwis, la puja mínima és de 1 Kiwi, i a partir d'aquí es pot augmentar el preu de 0.5 Kiwis en 0.5 Kiwis (és a dir, les pujes vàlides per a una assignatura són: 1K, 1.5K, 2K, 2.5K, 3K,3.5K, etc.)

Un programa recullirà els resultats i otorgarà cada matèria al major pujador. En cas d'empat, es quedarà la matèria aquell professor qui partís de més kiwis al començament. En cas de tornar a haver empat, la assignatura quedarà lliure amb el valor obtingut com a valor inicial per a la següent subhasta.

D'aquesta manera es realitzaran tres subhastes. (En la última hi haurà la possibilitat de pujar amb Kiwis negatius: els pofessors poden oferir-se a fer una assignatura a canvi de rebre fins a 5 kiwis a canvi (pujant per -5 Kiwis)).

\subsubsection{Revalorització hores}

Suposem que tenim l'assignatura $A$ i volem revaloritzar-la en hores una vegada finalitzada la subhasta.
Suposem que durant la subhasta $x$ professors han pujat per l'assignatura i que el guanyador ha pagat $y$ kiwis per ella. Definim les següents funcions:

$$\varphi (x)=\frac{x}{x+a}\ ,\  \psi(y)=\frac{y}{y+b} \quad a,b\in\mathbb{R}^{+} $$
	
Llavors, per revaloritzar les assignatures proposem la següent formula:
$$h_f(x,y,h_0)=h_0(1-c_1\varphi(x)-c_2\psi (x))\esp ,\esp c_1,c_2\in\mathbb{R}^+$$
On $h_0$ és el nombre d'hores inicial en que està valorada una assignatura. Les constants $c_1,c_2$ són per donar-li més pes a una variable que a l'altra. La funció està dissenyada per tal de que la part que multiplica $h_0$ estigui acotada per $1$. Per tant s'ha de complir:
$$
c_1+c_2=1
$$
Cal triar doncs unes constants que reflecteixin la importància de cada una de les variables en la funció. Tenimen compte els següents fets per fer la tria:
\begin{itemize}
\item Que $y$ sigui gran no implica necessàriament que $x$ ho sigui. És a dir, que una assignatura es vengui per un valor elevat no implica que hi hagin molts professors interessats en ella. 
\item Contràriament, una $x$ gran sí que, per norma general, implicaria un valor de $y$ elevat.
\end{itemize}
Per tant, creiem que la variable $x$, i per conseqüència la funció $\varphi$ haurien de tenir més pes sobre la funció final ja que aquesta és en la qual es reflexa de millor manera L'interès que hi ha per una assignatura. Triem doncs les constants de les següent manera:
$$c_1=0.7\ ,\ c_2=0.3$$
Una vegada tenim les constants $c_i$ ens cal determinar $a,b$ de les funcions petites. Per fer-ho considerarem diversos casos concrets on tenim clar com hauria de ser la revalorització i prenem les constants que més ens satisfacin.
	\\
	Suposem doncs la següent situació que es la més habitual: Tenim la assignatura $A$ per la qual han pujat dues persones ($x=2$) i s'ha adjudicat per un preu de 5 kiwis ($y=5$). Aquesta, esta valorada inicialment amb 20 hores ($h_0=20$). Aquest valor inicial el posem basat en la mitjana de hores que acostuma a tenir una assignatura. Per tal de que la revalorització fos prou bona, el preu d'aquesta assignatura ha de ser dues terceres parts del valor inicial. Per tant, utilitzant la funció tindríem:
	$$20\cdot\frac{2}{3}=h_f(2,5,20)=20(1-0.7\frac{2}{2+a}-0.3\frac{5}{5+b})$$
	Sense oblidar-nos d'aquest cas, considerem-ne un de més conflictiu: Suposem que tenim una assignatura per la qual hem fet una puja 5 persones ($x=5$) i el preu final d'aquesta ha sigut de 10 kiwis ($y=10$) i valorada inicialment amb $10$ hores. Amb un preu tan alt i amb tants professors interessats en ella aquesta assignatura hauria de ser revaloritzada a 10 hores, Tenim doncs:
	$$10=h_f(5,10,20)=20(1-0,7\frac{5}{5+a}-0.3\frac{10}{10+b})$$
	Si resolem el sistema donat per les dues equacions anteriors obtenim:
	$$a=\frac{1}{5}\cdot (27+\sqrt{229})\approx 8.42$$
	$$b=\frac{1}{2}\cdot(111-7\sqrt{229})\approx 2.53$$
	Fent unes quantes proves concloem que aquestes constants ens donen resultats prou satisfactoris. Per tant la funció de revalorització serà de la forma:
	
	$$h_f(x,y,h_0)=$$ $$h_0\cdot (1-0.7\cdot \frac{x}{x+\frac{1}{5}(27+\sqrt{229})}-0.3\cdot\frac{y}{y+\frac{1}{2}(111-7\sqrt{229})} )$$
	\begin{figure}[ht]
		\centering
		\includegraphics[width=9cm]{kiww}
		\caption{Gràfica de la funció $h_f(x,y,h_0)$ per $h_0=45$ i fent variar $x$ i $y$, on $x$ és el nombre de professors que pugen per l'assignatura i $y$ el preu en $kiwis$ que ha pagat el guanyador de la puja.}
		\label{fig:444}
	\end{figure}

\subsubsection{Assignacions finals}

Amb aquesta nova revalorització horària, es repartiran les matèries no assignades mitjançant el mètode de la funció entre els professors que tinguin de moment cobert un valor inferior a $\frac{2M}{3}$ hores, on M són les hores que ha de realitzar aquell professor.
\subsection{Subhastes condicionals i n-dimensionals}
\subsubsection{Problemàtiques de les  subhastes}
Aquí tenim un resum de les problemàtiques que ha de soluciona el model de subhasta que considerem construir 
\begin{tcolorbox}[colback=black!1,title=\textbf{Llista problemàtiques subhastes},coltitle=black,colbacktitle=black!10]
\begin{itemize}
	\item Les subhastes seran \textbf{seqüencials} o \textbf{simultànies}? Ja que les simultànies  poden implicar un \textbf{bloqueig de moneda} i les seqüencials poden implicar la inviabilitat de les \textbf{sol·licituds condicionals} i  massa temps en executar-se, almenys \textit{ a priori}.
	\item Com assignem les assignatures que no ha sol·licitat ningú?
	\item Les situacions de condicionals, com ara la puja de fer una assignatura condicionada a si  és compleix una condició.{\color{black!70} Per exemple impartir amb un docent amb qui es té  \textit{bon tracte}, o bé tenir interès en un conjunt d'assignatures com a global i no per separat, per exemple, per conveniència horària}.
		\item Cas pràctic. Elegir assignatures per conveniència horària més  que per preferència de la matèria a impartir, sota la suposició de ser un criteri raonable i \textit{comú} en les dades històriques. {\color{black!70} Per exemple voler impartir classe el menor nombre de dies per dificultats en el transport.}
			\item Tot sistema que incentivi a mentir afavorira la especulació que farà poc \textbf{eficient} l'assignació final.
		\item Una assignació \textbf{optima} en tot cas haurà de  minimitzar la diferencia entre les \textbf{hores reals} i les \text{hores ideals}. 
\end{itemize}
\end{tcolorbox}

\begin{tcolorbox}[colback=black!1]
\begin{itemize} 
	\item Tot sistema que incentivi a mentir afavorira la especulació que farà poc \textbf{eficient} l'assignació final.
	\item Una assignació \textbf{optima} en tot cas haurà de  minimitzar la diferencia entre les \textbf{hores reals} i les \text{hores ideals}.
	\item Com desitgem una \textbf{revaloració} \footnote{Que pot ser la mateixa o no.} de cada matèria docent subhastada assumim que ha de ser necessari que la subhasta influeixi en el valor final de cada assignatura, en principi el valor en hores s'haurà de modificar.
	\item Situació de empat. {{\color{black!70}En cas de \textbf{subhasta simultània} .}}
\end{itemize}
\end{tcolorbox}
\subsubsection{Construcció primer model}

Molts d'aquests problemes es poden solucionar utilitzant un concepte ja molt desenvolupat en la matemàtica, les \textbf{subhastes combinatorials}\cite{CA}, aquest tipus de subhastes es basen en la idea de que les pujes es realitzen sobre \textbf{blocs d'objectes}, així es realitzen pujes sobre un conjunt d'objectes de manera que si el participant aconsegueix guanyar tots els objectes la puja s'executa però si hi ha algun dels objectes del bloc que el participant no pot obtenir tota la puja queda invalidada.

És clar veure que una realització en paral·lel d'aquestes puges soluciona tots els nostres problemes, ja que eliminem la necessitat de \textbf{bloquejar moneda}, acomoda la possibilitat de que els participants tinguin dependències entre objectes a subhasta (ex: només els interessa el objecte A si poden obtenir el B), generen assignacions \textbf{òptimes}, i aplicant \textbf{subhastes de Vickrey} també resoldríem el problema d'evitar \textbf{l'especulació}, ja que incentivaríem als participants als  que pugessin el preu que creuen que val l'objecte (Això està demostrat\footnote{https://en.wikipedia.org/wiki/Vickrey\_auction \\
	\#Proof\_of\_dominance\_of\_truthful\_bidding}).

No obstant, el problema d'aquestes subhastes és que, donades les puges, determinar els guanyadors de cada objecte subhastat tal que l'assignació sigui òptima requereix l'aplicació d'un \textbf{algoritme NP-complet}, concretament un algorisme que creix de forma factorial respecte el nombre de pujes. Aquesta complexitat fa que l'aplicació de l'algoritme sigui totalment inviable per al nostre problema, ja que requeriria un temps de comput superior a la vida de l'univers.

Per solucionar aquest problema, hem dissenyat un nou tipus de subhasta, la \textbf{subhasta condicional}, a partir de la qual podem crear un sistema que ens permeti aconseguir els beneficis de les \textbf{subhastes combinatorials} a la vegada que evitem el problema de la \textit{explosió en complexitat}.

Definim una \textbf{subhasta condicional} com una subhasta on les pujes poden dependre dels resultats d'altres pujes. En aquest sistema podem crear pujes que només siguin valides si $n$ altres pujes diferents acaben guanyant les seves subhastes corresponents. \textit{Un exemple d'aquest tipus de puja seria una, que anomenarem $P$ que només seria considerada pel sistema si dos altres pujes $A$ i $B$ acaben sent pujes guanyadores, això significa que si una altra puja que no fos $A$ acabés guanyant la subhasta de la que $A$ és part, $P$ quedaria invalidada i seria com si mai hagués existit, menters que si $A$ i $B$ ambdós guanyessin $P$ actuaria com una puja normal en altres sistemes}.

Una de les propietats \textit{interessants} d'aquest sistema és que es pot demostrar que aquest tipus de subhastes són equivalent al problema del guanyador en les pujes de les \textbf{subhastes combinatorials}. En altres paraules, existeix un \textbf{algorisme polinomial} que permet transformar qualsevol dels dos problemes l'un en l'altre i també permet transformar una solució correcta de un en el seu problema equivalent \footnote{Estem en procés d'escriure un \textit{paper} amb la demostració d'aquest fet i la majoria de les altres afirmacions que realitzarem sobre les \textbf{subhastes condicionals}, quan estigui acabat el paper també serviria com a extensió d'aquest treball, però no hem sigut capaços d'acabar-lo a temps. No és cap peu de nota del estil \textit{Pierre de Fermat}.}. 

Això és molt important, ja que com els dos problemes són \textit{intercanviables}, si aconseguim trobar una forma de solucionar el problema del gunayador en subhastes condicionals haurem aconseguit, per extensió, resoldre el mateix problema en subhastes combinatorials. I en cas de haver-ho resolt en temps polinomial directament tindríem una demostració de que $P=NP$ \footnote{S'ha revisat el text i s'ha mantingut la \textit{forma} però caldria advertir que dispenses la prepotència fruit de la \textit{il·lusió} pels \textit{possibles} resultats.}. La part més \textit{emocionant} és que efectivament la idea de plantejar puges condicionals és nova en la \textit{literatura}, de manera que estem pensant el problema com mai ningú l'ha pensat abans \footnote{Almenys que haguem descobert nosaltres amb les nostres eines de cerca relativament \textit{limitades}}, de forma que és possible que trobem algun \textit{camí} no explorat.

A partir del concepte de \textbf{subhastes condicionals} desenvolupem el següent algoritme, el qual tot i no arribar a poder demostrar $P=NP$ ens permet ficar unes restriccions sobre el problema, en base a les quals podem resoldre el problema en temps polinomial:

\subsubsection{Algoritme 1}

De forma constructiva, i aprofitant la subsecció prèvia, construirem un model que compleixi les condicions  de la llista anterior.
L'algoritme proposat opera utilitzant subhastes a la baixa per hores (el professor que estigui disposat a fer una assignatura per menys hores se la queda), però seria trivial modificar-lo per utilitzar subhastes a l'alta amb kiwis o algun altre tipus de moneda.

\begin{enumerate}
	\item Els professors \textit{entren totes les seves pujes} (que poden estar condicionades sobre altres puges). No s'aplica \textbf{bloqueig de moneda} sobre les puges que pot realitzar un participant.
	\item Es calcula el guanyador (puja mínima per subhastes a la baixa) de totes les subhastes \textit{una rere l'altra}. En cas de trobar una \textbf{puja} \textbf{condicionada} sobre una subhasta que no s'ha executat es considera la puja com a \textit{bona} i s'executa la subhasta com si fos una puja \textit{normal}, a la vegada que es fa una \textit{anotació} marcant que aquesta puja depèn dels resultats futurs d'una altra subhasta futura. Quan l'altra subhasta s'executi, i obtinguem els resultats de qui ha sigut el guanyador d'aquesta, es revisita la \textbf{subhasta depenent} i, en cas que la \textbf{puja condicional} ja no sigui vàlida, aquesta subhasta és tornar a executar ignorant la puja invalidada. Aquestes invalidacions es propaguen sobre totes les subhastes deprenents.
	\item Seleccionar el professor al que la suma d'hores de les assignatures que se li han assignat sigui màxima entre tots els professors restants.
	\item Decidir mitjançant un algorisme de \textbf{complexitat polinomial}, el qual podria ser definit per cada professor, o estar basat en una \textit{llista de preferències} o simplement ser \textit{arbitrari}, quin subconjunt del conjunt d'assignatures assignades al professor seleccionat es vol quedar (el subconjunt amb el que es quedi ha de complir que la suma total de hores de les assignatures amb les que es quedi ha de ser \textit{semblant} al nombre de hores que hauria de realitzar \footnote{en cas d'estar en un sistema de puges a l'alça, ha de complir que la suma total de valors de les puges ha de ser inferior o igual al total de \textit{diners en possessió}}), per després \textit{desassignar-li} totes les altres assignatures que no ha seleccionat, de forma que el nombre d'hores totals de les assignatures assignades a ell sigui semblant al nombre d'hores que ha de fer. A continuació, aquest professor, les seves puges i les assignatures que se li han assignat són eliminats del sistema.
	\item Si enacara queden professors sense assignar assignatures, tornar al pas \textbf{2.} . En cas contrari, ja hem acabat i l'assignació final ja està feta (queda assignar les assignatures que no ha volgut ningú i \textit{vigilar} que no hi hagi professors que hagin quedat amb molt poques assignatures assignades), és a dir, obtenim la nostra \textbf{solució}.
\end{enumerate}

Podem veure que aquest algorisme \textbf{convergirà} \footnote{A la pràctica és que acabara en un nombre finit de passos.} (ja que en cada iteració eliminem elements del problema de manera que eventualment ens quedarem sense elements) i que serà \textbf{polinòmic} respecte al nombre de professors.

Respecte a la \textbf{optimalitat} de l'algorisme, es pot demostrar que no ho és, ja que es poden donar \textbf{contraexemples} on hi hagi ineficiències en l'assignació entre diferents iteracions del \textbf{procés iteratiu} (per exemple: si un participant guanya una subhasta però després no es queda amb l'objecte estarà privant altres participants que ja estan fora del sistema de la possibilitat d'obtenir l'objecte en qüestió que potser també desitjaven). 

A més, aquest \textbf{sistema} o \textbf{mètode} no resol correctament casos en que les assignatures dependents tinguin puges amb valors molt superiors als valors de les assignatures de les que depenen.
\textit{Per exemple: si un participant puja 10 per un item, fent la puja dependent en una altra puja de valor 1, serà possible eliminar les dos pujes amb una única puja de 2 de manera que observem ineficiecies ja que el sistema podia haver obtingut 11 monedes o 2 i ha triat 2.}

El primer cas d'\textbf{ineficiència} resulta bastant més difícil de tractar, però es pot argumentar que \textbf{passarà poc sovint} ja que el sistema desincentiva \textit{fortament} aquest tipus de comportament. Això és així perquè si un participant envia puges molt baixes (altes) en un sistema a la baixa (alta), llavors serà inevitable que guanyi moltes d'aquestes i acabi sent un dels primers en haver de seleccionar assignatures. En aquest cas es veurà forçat a agafar moltes assignatures a un valor d'hores molt baix i a no tenir disponible per a seleccionar assignatures que li interessaven i podria haver obtingut (ja que els guanyadors d'aquestes subhastes podrien haver acabat refusant aquestes assignatures). 

D'aquesta manera el sistema \textbf{alinea els incentius} de tots els participants, incentivant a que aquests només pugin per les assignatures que els interessen, sense utilitzar \textbf{preus inflats} ja que els participants que no segueixin aquest comportament acabaran \textbf{castigats} de la forma explicada anteriorment (menys possibilitats disponibles i forçats a agafar opcions \textit{ dolentes}).

Respecte a la segona \textbf{ineficiència} descrita, podem deduir que els casos en que sorgirà aquesta ineficiència seran poc comuns, ja que en el cas en que una assignatura depèn d'una altra això significa que al participant li interessa molt més la assignatura \textbf{sense dependències}, així que seguint un comportament racional, el participant hauria de fer una puja \textit{relativa més gran} sobre la assignatura no dependent, causant  la aparició de casos com el descrit sigui poc comuna. A més, en cas de que ocorri, serà molt més fàcil de detectar per part del participant que creí la puja, i com que aquest té incentius per no perdre la subhasta, modificaria les puges o en \textit{cercara} de noves per evitar que aparegués aquest cas.

Tot això ens permet concloure que, si bé és cert que el algoritme proposats no arriba a ser òptims, on la \textbf{pèrdua d'optimalitat} que causarà serà \textit{baixa} de forma que la seva aplicació acabarà generant assignacions que estaran \textit{molt a prop de l'òptim}, de forma que, per definició, seran assignacions \textit{molt bones}.

\subsubsection{Algoritme 2}
Un altra possible solució al problema de les subhastes combinatorials (\textit{Combinatorial auction}) és la realització de \textbf{subhastes angleses} (totes les pujes són públiques i la puja més alta guanya, pagant el preu d'aquesta mateixa puja) utilitzant el concepte de \textbf{puges condicionals explicat anteriorment}.

Es pot demostrar que aquest sistema genera una assignació \textbf{òptima}, definint òptim com a maximització del guany del venedor, però el problema sorgeix en que també es pot demostrar que ès possible que aquestes subhastes mai \textbf{convergeixin}, donat que aquest sistema fa possible \textbf{l'existència de bucles} en les puges.

Una solució per combatre aquesta falta de \textbf{convergència} és l'aplicació de sistemes externs que forcin la convergència, com l'aplicació d'una \textbf{taxa} sobre les puges (per cada nova puja realitzada el participant ha de \textit{pagar} una taxa) o també seria possible la imposició d'una \textbf{data límit} a les subhastes, de manera que a partir d'aquesta data és tanquin.

Aquestes solucions no són \textit{perfectes} ja que trenquen les \textbf{assumpcions} que possibilitin que les assignacions que generava el sistema fossin òptimes, però és possible que aquesta pèrdua d'optimalitat sigui inferior a les dels altres sistemes presentats en aquest treball. Per a saber-ho del cert s'hauria de realitzar un anàlisis més profund de l'algorisme, el qual no està dins de l'abast d'aquest treball.

\subsubsection{Recerca futura}
No ho hem pogut investigar per falta de temps, però creiem que afegir un \textbf{mercat lliure} post-subhasta on es permeti l'intercanvi d'assignatures entre professors podria aportar un element equilibrador al sistema que, juntament amb un sistema de subhasta \textit{ben calibrat}, permetés assolir l'optimalitat.

\subsubsection{Model de subhastes multidimensionals}
Una altra possible idea que es pot aplicar juntament amb les altres idees donades és la de les subhastes \textbf{multidimensionals}, en les quals assignem un vector a cada puja on cada \textbf{dimensió}\footnote{Volem dir component.} del vector representa un part de la puja diferent: Alguns elements poden estar directament definits per l'usuari, com la quantitat de diners que puja, i altres són directament calculats en funció de l'estat, com podria ser un valor que és el saldo en hores de l'usuari en l'assignació de l'any anterior.

En aquest \textbf{espai de vectors} de pujes es podria definir una \textbf{norma} que ens donés un \textbf{valor escalar} a partir del \textbf{vector}, finalment utilitzaríem aquest valor escalar per a realitzar les subhastes de la mateixa manera que actualment les subhastes es basen en la suma econòmica de cada puja.

Aquesta sistema tindrà l'\textit{avantatge} de poder incorporar \textbf{diversos factors a les subhastes}, permetent així una distribució més flexible i justa, a la vegada que és totalment compatible amb tots els sistemes de subhasta actual, de forma que es podria aplicar a qualsevol subhasta simplement com a una extensió d'aquesta.



\newpage															
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                 %%
%    #07            Conclusions                   %%
%                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{tcolorbox}[colframe=white,colback=redviolet!20,sharp corners=all,size=minimal,halign=center,valign=center]
	\section{Conclusions}
\end{tcolorbox}
	En aquest projecte hem explorat diversos \textbf{mètodes} per a realitzar assignacions, cada un dels quals ha tingut diversos punts forts i febles:
	
	El \textbf{model d'optimització} és \textit{molt flexible} i ens permet trobar assignacions de forma \textbf{completament personalitzable} però, a causa de la \textbf{mida exorbitada de l'espai de cerca}, ens resulta impossible donar garanties sobre la qualitat del resultat. A la practica comprovem \textbf{empíricament} que els algoritmes d'optimització empleats \textbf{arriben a solucions bastant bones}.
	
	El \textbf{model dels kiwis} resulta ser un model \textbf{simple} que compleix amb tots els requisits, en el que els \textbf{usuaris} tenen \textbf{control directe} sobre el resultat. L'ús de subhastes permet crear un sistema poc complex sense problemes de complexitat intractable on arribem a aconseguir \textbf{certa optimalitat} en l'assignació gràcies al sistema d'incentius i la teoria de jocs que es desenvolupa al voltant d'aquestes subhastes. No obstant, com que les subhastes utilitzades no s'acaben d'adaptar al nostre cas d'ús, \textbf{observem diverses ineficiències} en el sistema que porten a pèrdues d'optimalitat per diversos aspectes.
	
	El model de \textbf{subhastes condicionals} aparèix com una solució als problemes d'eficiència del model dels kiwis. Basat en les subhastes combinatorials, soluciona el problema de la complexitat d'aquestes gràcies  a la creació d'un \textbf{algorisme} de decisió de guanyador juntament amb un \textbf{sistema d'incentius} que aconsegueix \textbf{eliminar alguns dels problemes} del sistema de kiwis i reduir les ineficiències presents en aquest. Però encara que obtenim una millora, aquest sistema no aconsegueix eliminar les ineficiències i augmenta considerablement la complexitat de la solució.
	
	Com podem apreciar, cap dels models explicats es \textit{perfecte en tot}, no obstant, combinant-los podem crear nous models que agafin les millors parts de cada sistema.
	
	\subsection{Métodes híbrids}
	L'agrupament d'un \textbf{sistema de subhastes} juntament amb \textbf{mètodes d'optimitzacó}, creant un sistema que faci una primera assignació utilitzant subhastes per després emplenar els forats en aquesta utilitzant models d'optimització sembla \textbf{la millor opció}, ja que aconseguim solucionar un dels problemes de les subhastes, l'assignació d'assignatures que no han rebut puges (la qual la realitzem directament per optimització), a la vegada que solucionem el \textbf{problema principal dels mètodes d'optimització}: \textbf{l'espai de cerca massa gran}, ja que, al haver realitzat subhastes abans, el nombre d'assignatures i professors que quedaran per assignar haurà estat reduït \textit{dràsticament} de manera que estarem \textbf{optimitzant} sobre \textit{espais tractables} sobre els quals podrem trobar el \textbf{mínim global} o aproximacions bones d'aquest.
	

\subsection{Exemple final}
\begin{itemize}
	\item Un exemple d'aplicació del \textbf{model d'investigació d'operacions} s'ha donat en la subsecció 3.5 Resultats.
	\item Donem ara un petit exemple per visualitzar les diferents parts del \textbf{model hibrid} proposat
	\begin{enumerate}
		\item Imaginem que tenim un departament amb 10 professors format per tres subdepartaments 
		\begin{itemize}
			\item {\color{red!60}$\blacksquare$} Subdepartament d'Anàlisis.
			\item {\color{green!60}$\blacksquare$} Subdepartament d'Àlgebra.
			\item {\color{blue!60}$\blacksquare$} Subdepartament de Matemàtica aplicada.
		\end{itemize}
		 \item Imaginem que en proporció 5:1 han de repartir-se les assignatures que els hi demanada la universitat, en aquest cas 50. \\ \texttt{[assignatures assignades 00]}
		 \item Pel \textbf{model actual} els docents que estiguin impartint assignatures amb prioritat tindran preferència per repetir l'assignatura si no han assolit el nombre màxim de temps que poden estar impartint-les. \\ \texttt{[assignatures assignades 10]}
		 \item Es promourà una \textbf{primera ronda de subhasta} (d'algun dels tipus comentats) revalorant les assignatures per la seva demanda. \\ \texttt{[assignatures assignades 30]}
		 \item Hi haurà una \textbf{segona ronda de subhastes} per decidir empats i incentivar l'adquisició d'assignatures no sol·licitades amb una petita recompensa (augment del nombre d'hores d'una assignatura) per incentivar al professorat.\\ \texttt{[assignatures assignades 45]}
		 \item Els casos restants d'assignatures que no s'hagin pogut assignar a cap professor s'assignaran de forma automatica mitjançant el \textbf{model de la funció F o d'optimització} \\ \texttt{[assignatures assignades 50]}
		 \item Finalment es facilitara canvis \textit{d'ultima hora} si són justificats tal com es fa amb el \textbf{model actual}. \\ \texttt{[assignatures assignades 50-2+2]}
		\end{enumerate}
\end{itemize}
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                 %%
%    #06_1     Criteris o dades recopilació       %%
%                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Apèndix}
Aquí hem afegit alguns dels criteris que hem fet servir per \textit{simulacions} no incloses que ens han servit per comprovar la viabilitat del \textbf{model d'optimització}. 
\begin{enumerate}
	\item \textbf{Paràmetres a optimitzar } (com a criteris) 
	\begin{enumerate}
		\item La diferencia entre el nombre d'hores que \textit{hauria de fer} un professor i les hores que \textit{finalment farà} ha de ser el més petita possible. {\color{gray} Considerem que és l'estat més ideal.} \textbf{(minimitzar)} 
		\item La quantitat d'assignatures assignades a cada professors ha de ser baixa. 
		{\color{gray}  Per evitar el cas de que part del professorat tingui un nombre elevat de matèries a impartir, malgrat contin poc cadascuna ja que puntualment és pot tenir un sobrevolem de treball.} \textbf{(minimitzar)}
		\item L'assignació de les assignatures entre el professorat s'hauria d'acostar el màxim possible a les sol·licituds particulars demandades. {\color{gray}  L'elecció ja és justificació prou per argumentar que és una \textbf{alternativa} desitjable.} \textbf{(maximitzar)}
		\item S'hauria d'evitar que el nombre total d'hores de classe al dia d'un professor superés certs límits per a tots els dies.
		\item Les assignatures assignades a un mateix professor han de tenir certa localitat temporal, és a dir, que hi hagi poca diferència temporal entre el final d'una i el començament de la següent.
		%{\color{gray} El motiu d'aquesta mesura és incentivar al professorat a invertir (opcionalment) en l'elaboració de material docent que malgrat el primer any de docencia li comporti un mayor esforç a la llarga sigui compensat, a més de millorar la docencia és clar.}
	\end{enumerate}
	\item \textbf{Restriccions} (com a criteris)
	\begin{itemize}
		\item No pot haver solapament d'hores entre les assignatures que ha d'impartir un mateix docent . {\color{gray} En essència això evita entre d'altres coses que un mateix docent hages d'estar a dos llocs diferents al'hora .} \textbf{(Restricció de existència)} 
		\item El interval de temps entre el final d'una sessió de treball i el inici d'una altre, impartides per un mateix professional docent, a diferents facultats ha de ser major o igual a 20 minuts. {\color{gray} Un model que no contemples la pèrdua de temps en efectuar desplaçaments físics difícilment serà eficient i probablement precari.} \textbf{(Restricció d'ordre)} 
		\item Les assignatures dels graus:
		\begin{enumerate} 
			\item Grau de Matemàtiques.
			\item Grau d'Estadística Aplicada.
			\item Grau de Matemàtica Computacional i Analítica de Dades.
		\end{enumerate}
		No podran ser impartides pel mateix docent durant més de tres anys seguits.
		{\color{gray} Aquesta restricció té justificació per imposició de dades històriques i pràctiques.} \textbf{(Restricció d'ordre)} 
		\item La resta d'assignatures dels vint-i-sis graus restants estarà limitada a quatre anys seguits de docència per un mateix docent. {\color{gray} Això per una banda implica un compromís de cara a la matèria impartida per cada docent, i per altra banda garanteix una estabilitat en el temari impartit de cara als estudiants.} \textbf{(Restricció d'ordre)} 
		\item  Les matèries  dels cursos tercer i quart impartides als tres graus propis del departament \footnote{Grau de Matemàtiques, grau d'Estadística Aplicada, grau de Matemàtica Computacional i Analítica de Dades}. Sols podran ser impartides per docents que pertanyin a la unitat/subdepartament més proper a la matèria.   {\color{gray} La justificació és prou raonable, donada la actual \textit{especificació} inherent a la ciència en la actualitat. Un exemple seria que l'assignatura de Topologia sols pot ser impartida per docents de \textit{l'unitat} o \textit{subdepartament} de Geometria i Topologia \footnote{Veure secció de  \textit{model actual}.} .} \textbf{(Restricció d'ordre)} 
	\end{itemize}
\end{enumerate}								
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                 %%
%    #06_2   	       Bibliografia 	          %%
%                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\footnotesize
\bibliographystyle{ieeetr}
\bibliography{Bib.bib}
\end{document}
%https://youtu.be/mANIqat5IC8





\begin{figure}
	\centering
	\includegraphics[width=4cm]{eps}
	\caption{En aquesta figura veiem una icona del format d'arxiu \texttt{.eps}}
	\label{fig:3}
\end{figure}
